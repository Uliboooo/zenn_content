<p>voisona
Talk等で出力された音声ファイルの名前を、同名のセリフを含むテキストファイルを参照して変換するツールをRustで書いてみたのでそれの紹介です。ほとんどREADMEのコピペかも。</p>
<p>ソースコードは今見ても綺麗とは言えないですが動作はちゃんとしてます。</p>
<p>https://github.com/Uliboooo/track2line</p>
<h2 id="guiもあります">GUIもあります</h2>
<p>GUI版を作ってみました</p>
<p>https://github.com/Uliboooo/track2line_gui</p>
<p>まだエラーハンドリングもしてないですが、一応動きます。</p>
<h2 id="lates-release">Lates Release</h2>
<p>https://github.com/Uliboooo/track2line/releases/latest</p>
<h2 id="このツールの概要と必要性">このツールの概要と必要性</h2>
<p>track2lineは、voisona
talkなどで書き出した音声ファイルが<code>Talk1_1.wav</code>のようにトラック番号がファイル名になっており、内容が分かりにくかったため、ファイル名をその音声のセリフにしたいと考えたため制作しました。</p>
<p>これにはセリフが含まれる音声ファイルと同名のテキストファイルが必要です。それを自動で参照してリネームしていきます。</p>
<div class="sourceCode" id="cb1"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="ex">vt_test</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="ex">├──</span> Talk1_1.txt</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="ex">└──</span> Talk1_1.wav</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="va">$cat</span> Talk1_1.txt</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="ex">これはテストです</span></span></code></pre></div>
<p>👆のようなファイルがあった際にtrack2lineを実行すると👇のようになります。</p>
<div class="sourceCode" id="cb2"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># コマンドか何かで実行</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="ex">*</span> 1.mp3                <span class="at">---</span><span class="op">&gt;</span> one.mp3</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="ex">ok?</span><span class="er">(</span><span class="ex">y/n</span><span class="kw">)</span><span class="op">&gt;</span>y</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="ex">success.</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="ex">├──renamed</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="ex">│</span>  ├── one.wav <span class="co"># 1.txtの中身を参照してone.wavに</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="ex">├──</span> 1.txt      <span class="co"># テキストファイル</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="ex">├──</span> bad.txt    <span class="co"># エラー判定用</span></span></code></pre></div>
<p>ちなみに、セリフをファイルを出力するには<strong>テキストファイルを含む</strong>的な項目にチェックを入れると同じディレクトリにセリフを含んだテキストファイルを書き出してくれます。</p>
<p><img
src="https://storage.googleapis.com/zenn-user-upload/e02db924f15a-20250417.png" /></p>
<h2 id="インストール">インストール</h2>
<p>実行ファイルを置く場所をパスに通すとどこからでも使えます。</p>
<p>一例としてmac + zshで</p>
<div class="sourceCode" id="cb3"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> export PATH=<span class="va">$PATH</span>:ユーザディレクトリに適当なフォルダ<span class="er">(</span><span class="ex">my_toolsなど</span><span class="kw">)</span><span class="ex">のフルパス</span> <span class="op">&gt;&gt;</span> ~/.zshrc</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="bu">source</span> ~/.zshrc</span></code></pre></div>
<p>もしくは、実行ファイルのパスをエイリアスに登録すると、フルパスで実行ファイルを指定しなくとも使用できるようになります。(Mac)</p>
<ol type="1">
<li>適当なフォルダに実行ファイルを置く</li>
<li>その実行ファイルのパスをaliasに設定</li>
</ol>
<div class="sourceCode" id="cb4"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;alias track2line=&#39;track2lineのフルパス&#39;&quot;</span> <span class="op">&gt;&gt;</span> ~/.zshrc<span class="kw">;</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="bu">source</span> ~/.zshrc<span class="kw">;</span></span></code></pre></div>
<h2 id="使い方">使い方</h2>
<p>READMEを結構ちゃんと書いたのでほとんどそれのコピペになります</p>
<h2 id="使い方-1">使い方</h2>
<p>実行方法は</p>
<ul>
<li>引数にパスを指定 👉 <a
href="#引数にパスを指定">引数にパスを指定</a></li>
<li>実行後にパスを指定
<ul>
<li>引数ではなく実行後にパスを入力 👉 <a
href="#引数ではなく実行後にパスを入力">引数ではなく実行後にパスを入力</a></li>
<li>実行ファイルのディレクトリを自動取得 👉 <a
href="#実行ファイルのディレクトリを自動取得">実行ファイルのディレクトリを自動取得</a></li>
</ul></li>
</ul>
<p>の3種類.</p>
<p>以下コードの実行に用いたテスト用のディレクトリ構造</p>
<div class="sourceCode" id="cb5"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> tree <span class="ex">tests</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="ex">tests</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="ex">├──</span> 1.txt   <span class="co"># テキストファイル</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="ex">├──</span> 1.wav   <span class="co"># 音声ファイル</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="ex">├──</span> bad.txt <span class="co"># エラー判定用</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> cat <span class="ex">1.txt</span>            </span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="ex">one</span>         <span class="co"># テキストファイルの内容</span></span></code></pre></div>
<h3 id="引数にパスを指定">引数にパスを指定</h3>
<div class="sourceCode" id="cb6"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> ./track2line <span class="ex">~/Desktop/tests</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="ex">*</span> 1.wav                <span class="at">---</span><span class="op">&gt;</span> one.wav</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="ex">ok?</span><span class="er">(</span><span class="ex">y/n</span><span class="kw">)</span><span class="op">&gt;</span>y</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="ex">success.</span></span></code></pre></div>
<h4
id="引数に指定する場合には対応する拡張子を変更できます">引数に指定する場合には対応する拡張子を変更できます</h4>
<p>*この例ではそれぞれのファイルの拡張子をmp3とrtfに変更しています.</p>
<div class="sourceCode" id="cb7"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> ./track2line <span class="ex">-a</span> mp3 <span class="at">-t</span> rtf ~/Desktop/tests</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="ex">*</span> 1.mp3                <span class="at">---</span><span class="op">&gt;</span> one.mp3</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="ex">ok?</span><span class="er">(</span><span class="ex">y/n</span><span class="kw">)</span><span class="op">&gt;</span>y</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="ex">success.</span></span></code></pre></div>
<h3
id="引数ではなく実行後にパスを入力">引数ではなく実行後にパスを入力</h3>
<p>実行ファイルをダブルクリックして入力を求めらた際にフォルダのパスを入力.</p>
<div class="sourceCode" id="cb8"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> ~/Develop/track2line/target/release/track2line <span class="kw">;</span> <span class="bu">exit</span><span class="kw">;</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="ex">input</span> Rust<span class="st">&#39;s Project folder path.</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="st">if you use current directory, just leave it blank.</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="st">&gt;&gt;~/Desktop/tests          # 👈パスを入力.</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="st">* 1.wav                ---&gt; one.wav</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="st">ok?(y/n)&gt;y</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="st">success.</span></span></code></pre></div>
<h3
id="実行ファイルのディレクトリを自動取得">実行ファイルのディレクトリを自動取得</h3>
<div class="sourceCode" id="cb9"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> ~/Desktop/tests/track2line <span class="kw">;</span> <span class="bu">exit</span><span class="kw">;</span> <span class="co"># 👈実行ファイルのパスを指定して実行してます.</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="ex">input</span> Rust<span class="st">&#39;s Project folder path.</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="st">if you use current directory, just leave it blank.</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="st">&gt;&gt;                                   # 👈パスを入力しなければ実行ファイルのパスが自動で入力されます.</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="st">* 1.wav                ---&gt; one.wav</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="st">ok?(y/n)&gt;y</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="st">success.</span></span></code></pre></div>
<h2 id="免責事項">免責事項</h2>
<p>このソフトウェアを使用したことによって生じたすべての障害・損害・不具合等に関しては、私と私の関係者および私の所属するいかなる団体・組織とも、一切の責任を負いません。各自の責任においてご使用ください。</p>
